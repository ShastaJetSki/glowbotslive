CREATE TABLE IF NOT EXISTS vendor_packages (
  package_id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  sheet_id uuid REFERENCES sponsor_sheets(sheet_id) ON DELETE CASCADE,
  tenant_id uuid,
  package_name text,
  color text,
  price numeric DEFAULT 0,
  sort_order int DEFAULT 0
);

CREATE TABLE IF NOT EXISTS vendor_package_items (
  item_id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  package_id uuid REFERENCES vendor_packages(package_id) ON DELETE CASCADE,
  sheet_id uuid,
  tenant_id uuid,
  item_name text,
  quantity int DEFAULT 0,
  value numeric DEFAULT 0,
  cost numeric DEFAULT 0,
  sort_order int DEFAULT 0
);

ALTER TABLE vendor_packages ENABLE ROW LEVEL SECURITY;
ALTER TABLE vendor_package_items ENABLE ROW LEVEL SECURITY;

DROP POLICY IF EXISTS vp_pkgs ON vendor_packages;
CREATE POLICY vp_pkgs ON vendor_packages FOR ALL USING (true);

DROP POLICY IF EXISTS vp_items ON vendor_package_items;
CREATE POLICY vp_items ON vendor_package_items FOR ALL USING (true);

ALTER TABLE ticket_package_items ADD COLUMN IF NOT EXISTS value numeric DEFAULT 0;
