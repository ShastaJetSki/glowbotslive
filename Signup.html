<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign Up - WorkLogicPro</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    
    body {
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
      background:#0a0e1a;
      color:#e8eef6;
      line-height:1.6;
    }

    /* Header */
    .header {
      background:#0f1621;
      border-bottom:1px solid #223044;
      padding:20px 40px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .logo {
      font-size:24px;
      font-weight:700;
      color:#2563eb;
    }
    .loginLink {
      color:#9fb0c3;
      text-decoration:none;
      transition:color 0.3s;
    }
    .loginLink:hover {
      color:#e8eef6;
    }

    /* Container */
    .container {
      max-width:1200px;
      margin:0 auto;
      padding:60px 20px;
    }

    /* Hero */
    .hero {
      text-align:center;
      margin-bottom:60px;
    }
    .heroTitle {
      font-size:48px;
      font-weight:800;
      margin-bottom:16px;
      color:#e8eef6;
    }
    .heroSubtitle {
      font-size:20px;
      color:#9fb0c3;
      margin-bottom:8px;
    }
    .heroTrial {
      font-size:16px;
      color:#10b981;
      font-weight:600;
    }

    /* Pricing Grid */
    .pricingGrid {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));
      gap:24px;
      margin-bottom:60px;
    }

    /* Price Card */
    .priceCard {
      background:#0f1621;
      border:2px solid #223044;
      border-radius:16px;
      padding:32px;
      position:relative;
      transition:all 0.3s;
    }
    .priceCard:hover {
      transform:translateY(-4px);
      border-color:#2563eb;
    }
    .priceCard.popular {
      border-color:#2563eb;
      background:#121a2e;
    }
    .popularBadge {
      position:absolute;
      top:-12px;
      left:50%;
      transform:translateX(-50%);
      background:#2563eb;
      color:#fff;
      padding:4px 16px;
      border-radius:20px;
      font-size:12px;
      font-weight:700;
      text-transform:uppercase;
    }
    
    .tierName {
      font-size:24px;
      font-weight:700;
      margin-bottom:8px;
      color:#e8eef6;
    }
    .tierPrice {
      font-size:48px;
      font-weight:800;
      color:#2563eb;
      margin-bottom:4px;
    }
    .tierPrice span {
      font-size:18px;
      color:#9fb0c3;
      font-weight:400;
    }
    .tierDesc {
      color:#9fb0c3;
      font-size:14px;
      margin-bottom:24px;
      min-height:40px;
    }
    
    .tierFeatures {
      list-style:none;
      margin-bottom:28px;
    }
    .tierFeatures li {
      padding:8px 0;
      color:#9fb0c3;
      font-size:14px;
      display:flex;
      align-items:flex-start;
      gap:8px;
    }
    .tierFeatures li:before {
      content:"✓";
      color:#2563eb;
      font-weight:700;
      flex-shrink:0;
    }
    .tierFeatures li.disabled {
      color:#4a5568;
      text-decoration:line-through;
    }
    .tierFeatures li.disabled:before {
      content:"✗";
      color:#4a5568;
    }
    
    .selectBtn {
      width:100%;
      padding:14px;
      background:#2563eb;
      color:#fff;
      border:none;
      border-radius:8px;
      font-size:16px;
      font-weight:600;
      cursor:pointer;
      transition:all 0.3s;
    }
    .selectBtn:hover {
      background:#1e40af;
      transform:scale(1.02);
    }
    .selectBtn.secondary {
      background:transparent;
      border:1px solid #2563eb;
      color:#2563eb;
    }
    .selectBtn.secondary:hover {
      background:#2563eb;
      color:#fff;
    }

    /* Signup Form */
    .signupForm {
      display:none;
      max-width:500px;
      margin:0 auto;
      background:#0f1621;
      border:1px solid #223044;
      border-radius:16px;
      padding:40px;
    }
    .signupForm.active {
      display:block;
    }
    
    .formTitle {
      font-size:28px;
      font-weight:700;
      margin-bottom:8px;
      text-align:center;
    }
    .formSubtitle {
      color:#9fb0c3;
      text-align:center;
      margin-bottom:32px;
    }
    .selectedTier {
      background:#1a2535;
      border:1px solid #2563eb;
      border-radius:8px;
      padding:16px;
      margin-bottom:24px;
      text-align:center;
    }
    .selectedTier .tierName {
      font-size:18px;
      color:#2563eb;
      margin-bottom:4px;
    }
    .selectedTier .tierPrice {
      font-size:32px;
    }
    
    .formGroup {
      margin-bottom:20px;
    }
    .formLabel {
      display:block;
      margin-bottom:8px;
      color:#9fb0c3;
      font-size:14px;
      font-weight:500;
    }
    .formInput {
      width:100%;
      padding:12px;
      background:#1a2535;
      border:1px solid #223044;
      border-radius:8px;
      color:#e8eef6;
      font-size:15px;
    }
    .formInput:focus {
      outline:none;
      border-color:#2563eb;
    }
    
    .submitBtn {
      width:100%;
      padding:16px;
      background:#2563eb;
      color:#fff;
      border:none;
      border-radius:8px;
      font-size:16px;
      font-weight:600;
      cursor:pointer;
      margin-top:24px;
    }
    .submitBtn:hover {
      background:#1e40af;
    }
    .submitBtn:disabled {
      opacity:0.5;
      cursor:not-allowed;
    }
    
    .backLink {
      text-align:center;
      margin-top:20px;
    }
    .backLink a {
      color:#2563eb;
      text-decoration:none;
    }
    .backLink a:hover {
      text-decoration:underline;
    }
    
    .message {
      padding:12px;
      border-radius:8px;
      margin-bottom:20px;
      font-size:14px;
    }
    .messageSuccess {
      background:#10b98120;
      border:1px solid #10b981;
      color:#10b981;
    }
    .messageError {
      background:#ef444420;
      border:1px solid #ef4444;
      color:#ef4444;
    }

    /* Footer */
    .footer {
      border-top:1px solid #223044;
      padding:40px 20px;
      text-align:center;
    }
    .glowbots {
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      margin-bottom:16px;
    }

    @media (max-width: 768px) {
      .heroTitle {
        font-size:32px;
      }
      .pricingGrid {
        grid-template-columns:1fr;
      }
    }
  </style>
</head>
<body>

  <div class="header">
    <div class="logo">WorkLogicPro</div>
    <a href="login-worklogic.html" class="loginLink">Sign In</a>
  </div>

  <!-- Pricing Section -->
  <div id="pricingSection" class="container">
    <div class="hero">
      <h1 class="heroTitle">Choose Your Plan</h1>
      <p class="heroSubtitle">Select the perfect plan for your business</p>
      <p class="heroTrial">14-day free trial, Starter: no credit card • Pro: credit card required</p>
    </div>

    <div class="pricingGrid">
      
      <!-- Starter -->
      <div class="priceCard">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
          <h3 class="tierName" style="margin-bottom:0;">Starter</h3>
          <span style="font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:13px;font-weight:600;color:#34d399;letter-spacing:0.5px;">Beta</span>
        </div>
        <div class="tierPrice">$29<span> per month</span></div>
        <p class="tierDesc">Perfect for solo operators</p>
        <ul class="tierFeatures">
          <li>1 user (owner)</li>
          <li>20 work orders per month</li>
          <li>Customer tracking</li>
          <li>Vehicle tracking</li>
          <li>Drag-and-drop scheduling</li>
          <li>Owner dashboard (lite)</li>
          <li>No AI features</li>
        </ul>
        <button class="selectBtn secondary" onclick="selectTier('starter', 'Starter', 29)">
          14-Day Free Trial
        </button>
      </div>

      <!-- Pro (Most Popular) -->
      <div class="priceCard popular">
        <div class="popularBadge">Most Popular</div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
          <h3 class="tierName" style="margin-bottom:0;">Pro</h3>
          <span style="font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:13px;font-weight:600;color:#93c5fd;letter-spacing:0.3px;">Available Soon</span>
        </div>
        <div class="tierPrice">$79<span> per month</span></div>
        <p class="tierDesc">For small teams</p>
        <ul class="tierFeatures">
          <li>3 users (owner plus 2 technicians)</li>
          <li>50 work orders per month</li>
          <li>Owner dashboard</li>
          <li>Parts dashboard</li>
          <li>Technician dashboard</li>
          <li>Full scheduling tools</li>
          <li>Drag-and-drop scheduling</li>
          <li>Technician utilization tracking</li>
          <li>No AI features</li>
        </ul>
        <button class="selectBtn" onclick="selectTier('pro', 'Pro', 79)">
          14-Day Free Trial (CC Required)
        </button>
      </div>

      <!-- Pro+ -->
      <div class="priceCard">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
          <h3 class="tierName" style="margin-bottom:0;">Pro+</h3>
          <span style="font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:13px;font-weight:600;color:#93c5fd;letter-spacing:0.3px;">Available Soon</span>
        </div>
        <div class="tierPrice">$99<span> per month</span></div>
        <p class="tierDesc">Pro features plus AI</p>
        <ul class="tierFeatures">
          <li>4 users</li>
          <li>100 work orders per month</li>
          <li>Owner dashboard</li>
          <li>Parts dashboard</li>
          <li>Technician dashboard</li>
          <li>Full scheduling tools</li>
          <li>Drag-and-drop scheduling</li>
          <li>Technician utilization tracking</li>
          <li>AI dashboard</li>
          <li>AI agents available (optional, not auto-added)</li>
          <li>AI usage billed through a wallet system</li>
          <li style="margin-top:12px;font-weight:600;color:#e8eef6;">
            Optional AI Add-Ons: 
            <a href="#ai-details" onclick="showAIDetails(); return false;" style="color:#60a5fa;font-size:11px;text-decoration:none;border-bottom:1px dotted #60a5fa;margin-left:8px;">details</a>
          </li>
          <li style="color:#60a5fa;">✓ Operations Agent — $29 per month</li>
          <li style="color:#60a5fa;">✓ Customer Agent — $39 per month</li>
        </ul>
        
        <button class="selectBtn secondary" onclick="selectTier('pro_plus', 'Pro+', 99)">
          Upgrade to Pro+
        </button>
      </div>

      <!-- Business -->
      <div class="priceCard">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
          <h3 class="tierName" style="margin-bottom:0;">Business</h3>
          <span style="font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:13px;font-weight:600;color:#93c5fd;letter-spacing:0.3px;">Available Soon</span>
        </div>
        <div class="tierPrice">$199<span> per month</span></div>
        <p class="tierDesc">Unlimited work orders</p>
        <ul class="tierFeatures">
          <li>8 users</li>
          <li>Unlimited work orders</li>
          <li>Owner dashboard</li>
          <li>Parts dashboard</li>
          <li>Technician dashboard</li>
          <li>Full scheduling tools</li>
          <li>Drag-and-drop scheduling</li>
          <li>Technician utilization tracking</li>
          <li>AI dashboard</li>
          <li>AI agents available (optional, not auto-added)</li>
          <li>AI usage billed through a wallet system</li>
          <li>Cross-manager visibility (read-only workload view)</li>
          <li>Enhanced support ticket system</li>
          <li>Data download access</li>
          <li style="margin-top:12px;font-weight:600;color:#e8eef6;">
            Advanced AI Agents: 
            <a href="#ai-details" onclick="showAIDetails(); return false;" style="color:#60a5fa;font-size:11px;text-decoration:none;border-bottom:1px dotted #60a5fa;margin-left:8px;">details</a>
          </li>
          <li style="color:#60a5fa;">✓ Advanced Operations Agent — $29 per month</li>
          <li style="color:#60a5fa;">✓ Advanced Customer Agent — $39 per month</li>
          <li style="color:#60a5fa;">✓ Advanced Parts Manager Agent — $29 per month</li>
        </ul>
        
        <button class="selectBtn secondary" onclick="selectTier('business', 'Business', 199)">
          Upgrade to Business
        </button>
      </div>

      <!-- Enterprise -->
      <div class="priceCard">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
          <h3 class="tierName" style="margin-bottom:0;">Enterprise</h3>
          <span style="font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:13px;font-weight:600;color:#93c5fd;letter-spacing:0.3px;">Available Soon</span>
        </div>
        <div class="tierPrice">$399<span> per month</span></div>
        <p class="tierDesc">Advanced analytics and automation</p>
        <ul class="tierFeatures">
          <li>20 users</li>
          <li>Unlimited work orders</li>
          <li>Owner dashboard</li>
          <li>Parts dashboard</li>
          <li>Technician dashboard</li>
          <li>Full scheduling tools</li>
          <li>Drag-and-drop scheduling</li>
          <li>Technician utilization tracking</li>
          <li>AI dashboard</li>
          <li>AI agents available (optional, not auto-added)</li>
          <li>AI usage billed through a wallet system</li>
          <li>Multi-manager dashboards</li>
          <li>Advanced analytics</li>
          <li>Automated reports</li>
          <li>Expanded cross-manager visibility</li>
          <li>Automatic data backups</li>
          <li>Scheduled data exports sent to your cloud storage provider</li>
          <li style="margin-top:12px;font-weight:600;color:#e8eef6;">
            Advanced AI Agents: 
            <a href="#ai-details" onclick="showAIDetails(); return false;" style="color:#60a5fa;font-size:11px;text-decoration:none;border-bottom:1px dotted #60a5fa;margin-left:8px;">details</a>
          </li>
          <li style="color:#60a5fa;">✓ Advanced Operations Agent — $29 per month</li>
          <li style="color:#60a5fa;">✓ Advanced Customer Agent — $39 per month</li>
          <li style="color:#60a5fa;">✓ Advanced Parts Manager Agent — $29 per month</li>
        </ul>
        
        <button class="selectBtn secondary" onclick="window.location.href='mailto:sales@worklogicpro.com?subject=Enterprise%20Plan%20Inquiry'">
          Contact Sales
        </button>
      </div>

      <!-- Custom Shop -->
      <div class="priceCard" style="position:relative;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
          <h3 class="tierName" style="margin-bottom:0;">Custom Shop</h3>
          <span style="font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:13px;font-weight:600;color:#93c5fd;letter-spacing:0.3px;">Available Soon</span>
        </div>
        <div class="tierPrice" style="font-size:32px;">Custom<span> pricing</span></div>
        <p class="tierDesc">Fully customized solution</p>
        <ul class="tierFeatures">
          <li>Custom dashboards designed around your workflow</li>
          <li>Custom workflows that match your repair and service process</li>
          <li>Custom AI configuration tailored to your operation</li>
          <li>Custom AI agents built for unique use cases</li>
          <li>Custom integrations with existing tools and systems</li>
          <li>Dedicated onboarding with hands-on setup assistance</li>
        </ul>
        <button class="selectBtn secondary" onclick="window.location.href='mailto:sales@worklogicpro.com'">
          Contact Sales
        </button>
        
        <!-- GlowBot Logo -->
        <div style="position:absolute;bottom:16px;left:16px;">
          <img src="glowbot.png" alt="GlowBot" style="height:32px;opacity:0.6;">
        </div>
      </div>

    </div>
  </div>

  <!-- Signup Form -->
  <div id="signupForm" class="signupForm">
    <h2 class="formTitle">Create Your Account</h2>
    <p class="formSubtitle">Start your 14-day free trial</p>

    <div class="selectedTier" id="selectedTierDisplay">
      <div class="tierName" id="displayTierName">Pro</div>
      <div class="tierPrice">$<span id="displayTierPrice">79</span><span> per month</span></div>
    </div>

    <div id="messageBox"></div>

    <form onsubmit="handleSignup(event)">
      <div class="formGroup">
        <label class="formLabel">Business Name</label>
        <input type="text" id="businessName" class="formInput" required placeholder="Your Business Name">
      </div>

      <div class="formGroup">
        <label class="formLabel">Your Name</label>
        <input type="text" id="fullName" class="formInput" required placeholder="John Doe">
      </div>

      <div class="formGroup">
        <label class="formLabel">Email</label>
        <input type="email" id="email" class="formInput" required placeholder="you@yourbusiness.com">
      </div>

      <div class="formGroup">
        <label class="formLabel">Phone</label>
        <input type="tel" id="phone" class="formInput" placeholder="(555) 123-4567">
      </div>

      <div class="formGroup">
        <label class="formLabel">Password</label>
        <input type="password" id="password" class="formInput" required placeholder="At least 8 characters" minlength="8">
      </div>

      <button type="submit" class="submitBtn" id="submitBtn">
        Start Free Trial →
      </button>
    </form>

    <div class="backLink">
      <a href="#" onclick="showPricing(); return false;">← Back to plans</a>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="glowbots">
      <span style="color:#6b7280;font-size:12px;">Powered by</span>
      <img src="glowbot.png" alt="GlowBot" style="height:20px;vertical-align:middle;">
      <a href="https://glowbotslive.com" target="_blank" style="color:#2563eb;text-decoration:none;font-weight:600;font-size:12px;">GlowBotsLive.com</a>
    </div>
    <p style="color:#6b7280;font-size:11px;">AI-Powered Business Solutions</p>
  </div>

  <!-- AI Details Modal -->
  <div id="aiDetailsModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:2000;padding:20px;overflow-y:auto;">
    <div style="max-width:700px;margin:40px auto;background:#0f1621;border:1px solid #2563eb;border-radius:16px;padding:40px;position:relative;">
      <button onclick="closeAIDetails()" style="position:absolute;top:16px;right:16px;background:transparent;border:none;color:#9fb0c3;font-size:24px;cursor:pointer;padding:8px;">&times;</button>
      
      <h2 style="color:#2563eb;margin-bottom:24px;font-size:28px;">AI Features & Agents</h2>
      
      <div style="margin-bottom:32px;">
        <h3 style="color:#e8eef6;font-size:20px;margin-bottom:12px;">How AI Wallet Works</h3>
        <p style="color:#9fb0c3;line-height:1.7;margin-bottom:16px;">
          AI usage is billed through a prepaid wallet system. You add funds to your wallet, and AI usage deducts from your balance. This gives you complete control over AI spending with no surprise charges.
        </p>
        <ul style="color:#9fb0c3;line-height:1.8;margin-left:20px;">
          <li>Add funds anytime ($10 minimum)</li>
          <li>Set optional spending limits</li>
          <li>Enable auto-reload when balance is low</li>
          <li>Typical usage: $0.10–$0.20 per minute</li>
          <li>AI stops when wallet balance reaches zero</li>
        </ul>
      </div>
      
      <div style="margin-bottom:32px;">
        <h3 style="color:#e8eef6;font-size:20px;margin-bottom:12px;">AI Agent Capabilities</h3>
        
        <div style="background:#0a1a2e;border:1px solid #223044;border-radius:8px;padding:20px;margin-bottom:16px;">
          <h4 style="color:#60a5fa;margin-bottom:8px;">Operations Agent — $29/month</h4>
          <p style="color:#9fb0c3;font-size:14px;line-height:1.6;">
            Automates workflow optimization, scheduling recommendations, and identifies bottlenecks in your operations. Provides insights on technician utilization and work order efficiency.
          </p>
        </div>
        
        <div style="background:#0a1a2e;border:1px solid #223044;border-radius:8px;padding:20px;">
          <h4 style="color:#60a5fa;margin-bottom:8px;">Customer Agent — $39/month</h4>
          <p style="color:#9fb0c3;font-size:14px;line-height:1.6;">
            Handles customer communication, sends automated updates, manages follow-ups, and provides intelligent responses to customer inquiries. Improves customer satisfaction and retention.
          </p>
        </div>
      </div>
      
      <div style="margin-bottom:32px;">
        <h3 style="color:#e8eef6;font-size:20px;margin-bottom:12px;">Frequently Asked Questions</h3>
        
        <div style="margin-bottom:16px;">
          <h4 style="color:#e8eef6;font-size:15px;margin-bottom:6px;">Are AI agents required?</h4>
          <p style="color:#9fb0c3;font-size:14px;line-height:1.6;">
            No, AI agents are completely optional add-ons. You can use Pro+ features without subscribing to any AI agents.
          </p>
        </div>
        
        <div style="margin-bottom:16px;">
          <h4 style="color:#e8eef6;font-size:15px;margin-bottom:6px;">Can I try AI agents before subscribing?</h4>
          <p style="color:#9fb0c3;font-size:14px;line-height:1.6;">
            Yes, each AI agent includes a 7-day trial period. Cancel anytime during the trial for no charge.
          </p>
        </div>
        
        <div style="margin-bottom:16px;">
          <h4 style="color:#e8eef6;font-size:15px;margin-bottom:6px;">What happens when my wallet runs out?</h4>
          <p style="color:#9fb0c3;font-size:14px;line-height:1.6;">
            AI features will pause until you add more funds. You'll receive notifications when your balance is low. Enable auto-reload to keep AI features running continuously.
          </p>
        </div>
        
        <div>
          <h4 style="color:#e8eef6;font-size:15px;margin-bottom:6px;">Can I cancel AI agent subscriptions?</h4>
          <p style="color:#9fb0c3;font-size:14px;line-height:1.6;">
            Yes, you can cancel any AI agent subscription at any time. You'll retain access through the end of your current billing period.
          </p>
        </div>
      </div>
      
      <button onclick="closeAIDetails()" style="width:100%;padding:14px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;">
        Got It
      </button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = 'https://kxqkwpkmtgvmthpafoqx.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt4cWt3cGttdGd2bXRocGFmb3F4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NDI1OTQsImV4cCI6MjA4MTAxODU5NH0.GT9pOMqrUr1EvVLh1magyoB4I_LprziRaybKsGHhrX4';
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let selectedTierData = {
      code: 'pro',
      name: 'Pro',
      price: 79
    };

    function selectTier(tierCode, tierName, tierPrice) {
      selectedTierData = { code: tierCode, name: tierName, price: tierPrice };
      
      // Update display
      document.getElementById('displayTierName').textContent = tierName;
      document.getElementById('displayTierPrice').textContent = tierPrice;

      // Show form, hide pricing
      document.getElementById('pricingSection').style.display = 'none';
      document.getElementById('signupForm').classList.add('active');
      
      // Scroll to top
      window.scrollTo(0, 0);
    }

    function showPricing() {
      document.getElementById('pricingSection').style.display = 'block';
      document.getElementById('signupForm').classList.remove('active');
      window.scrollTo(0, 0);
    }

    function showAIDetails() {
      document.getElementById('aiDetailsModal').style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeAIDetails() {
      document.getElementById('aiDetailsModal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    async function handleSignup(e) {
      e.preventDefault();
      
      const btn = document.getElementById('submitBtn');
      const msgBox = document.getElementById('messageBox');
      
      btn.disabled = true;
      btn.textContent = 'Creating account...';
      msgBox.innerHTML = '';

      try {
        const businessName = document.getElementById('businessName').value.trim();
        const fullName = document.getElementById('fullName').value.trim();
        const email = document.getElementById('email').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const password = document.getElementById('password').value;

        // 1. Sign up user
        const { data: authData, error: authError } = await supabase.auth.signUp({
          email: email,
          password: password
        });

        if (authError) throw authError;

        // 2. Get WorkLogic brand
        const { data: brand, error: brandError } = await supabase
          .from('brands')
          .select('brand_id')
          .eq('brand_code', 'worklogic')
          .single();

        if (brandError) throw brandError;

        // 3. Get selected tier
        const { data: tier, error: tierError } = await supabase
          .from('subscription_tiers')
          .select('tier_id')
          .eq('brand_id', brand.brand_id)
          .eq('tier_code', selectedTierData.code)
          .single();

        if (tierError) throw tierError;

        // 4. Create tenant
        const { data: tenant, error: tenantError } = await supabase
          .from('tenants')
          .insert({
            business_name: businessName,
            brand_id: brand.brand_id,
            tier_id: tier.tier_id,
            subscription_status: 'trial',
            trial_ends_at: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString(),
            subscription_started_at: new Date().toISOString()
          })
          .select()
          .single();

        if (tenantError) throw tenantError;

        // 5. Create owner employee
        const nameParts = fullName.split(' ');
        const firstName = nameParts[0];
        const lastName = nameParts.slice(1).join(' ') || '';

        const { error: empError } = await supabase
          .from('employees')
          .insert({
            tenant_id: tenant.tenant_id,
            user_id: authData.user.id,
            first_name: firstName,
            last_name: lastName,
            email: email,
            phone: phone || null,
            role: 'owner',
            is_active: true
          });

        if (empError) throw empError;

        // Success!
        msgBox.innerHTML = '<div class="message messageSuccess">✓ Account created! Redirecting to dashboard...</div>';
        
        setTimeout(() => {
          window.location.href = 'dashboard-business.html';
        }, 2000);

      } catch (err) {
        console.error('Signup error:', err);
        msgBox.innerHTML = `<div class="message messageError">Error: ${err.message}</div>`;
        btn.disabled = false;
        btn.textContent = 'Start Free Trial →';
      }
    }
  </script>

</body>
</html>
