<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Screen Design Tracker</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #0b0f14;
      min-height: 100vh;
      padding: 20px;
      color: #e8eef6;
    }

    .container {
      max-width: 1800px;
      margin: 0 auto;
    }

    /* Header */
    .header {
      background: #0f1621;
      border: 1px solid #2d3f56;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header h1 {
      color: #60a5fa;
      font-size: 28px;
      font-weight: 700;
    }

    .header-nav {
      display: flex;
      gap: 12px;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 8px;
      border: 1px solid #2d3f56;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      color: white;
      background: #3b82f6;
      font-size: 14px;
    }

    .btn:hover {
      background: #2563eb;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
    }

    .btn.secondary {
      background: #1e40af;
    }

    .btn.success {
      background: #10b981;
    }

    /* Board */
    .board {
      background: #0f1621;
      border: 1px solid #2d3f56;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    /* Column Manager */
    .column-manager {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      padding: 12px;
      background: #1a2535;
      border-radius: 8px;
      border: 1px solid #2d3f56;
      flex-wrap: wrap;
    }

    .column-tag {
      padding: 6px 12px;
      background: #0f1621;
      border: 1px solid #2d3f56;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      color: #94a3b8;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .column-tag input {
      background: transparent;
      border: none;
      color: #e8eef6;
      font-size: 11px;
      font-weight: 600;
      width: 80px;
    }

    .column-tag button {
      background: none;
      border: none;
      color: #ef4444;
      cursor: pointer;
      font-size: 14px;
      padding: 0;
    }

    .column-tag button:hover {
      color: #dc2626;
    }

    /* Screen Row */
    .screen-row {
      background: #1a2535;
      border: 1px solid #2d3f56;
      border-radius: 10px;
      margin-bottom: 12px;
      overflow: hidden;
      transition: all 0.2s;
    }

    .screen-row:hover {
      border-color: #3b82f6;
    }

    /* Main Row - Always Visible */
    .row-main {
      display: grid;
      grid-template-columns: 240px 60px repeat(var(--cols), 110px) 100px;
      gap: 12px;
      padding: 12px 16px;
      align-items: center;
    }

    .screen-title {
      font-weight: 600;
      font-size: 15px;
      color: #e8eef6;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Phone Outline Icon */
    .phone-outline {
      width: 48px;
      height: 48px;
      border: 2px solid;
      border-radius: 8px;
      position: relative;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .phone-outline::before {
      content: '';
      width: 20px;
      height: 1px;
      background: currentColor;
      position: absolute;
      top: 6px;
    }

    .phone-outline::after {
      content: '';
      width: 12px;
      height: 12px;
      border: 2px solid currentColor;
      border-radius: 50%;
      position: absolute;
      bottom: 6px;
    }

    .phone-outline:hover {
      transform: scale(1.1);
      box-shadow: 0 0 12px currentColor;
    }

    /* 10 Tech Blue Colors */
    .color-0 { border-color: #3b82f6; color: #3b82f6; }
    .color-1 { border-color: #06b6d4; color: #06b6d4; }
    .color-2 { border-color: #10b981; color: #10b981; }
    .color-3 { border-color: #8b5cf6; color: #8b5cf6; }
    .color-4 { border-color: #6366f1; color: #6366f1; }
    .color-5 { border-color: #14b8a6; color: #14b8a6; }
    .color-6 { border-color: #0ea5e9; color: #0ea5e9; }
    .color-7 { border-color: #a855f7; color: #a855f7; }
    .color-8 { border-color: #22d3ee; color: #22d3ee; }
    .color-9 { border-color: #818cf8; color: #818cf8; }

    /* Progress Cell - Column Name Inside */
    .progress-cell {
      height: 48px;
      border-radius: 8px;
      border: 2px solid #2d3f56;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      user-select: none;
      transition: all 0.2s;
    }

    .progress-cell:hover {
      transform: scale(1.03);
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }

    .cell-label {
      font-size: 9px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      opacity: 0.7;
      margin-bottom: 2px;
    }

    .cell-percent {
      font-size: 14px;
      font-weight: 700;
    }

    /* Progress States */
    .p-0 {
      background: #0f1621;
      color: #64748b;
      border-color: #2d3f56;
    }

    .p-25 {
      background: #78350f;
      color: #fcd34d;
      border-color: #f59e0b;
    }

    .p-50 {
      background: #1e40af;
      color: #93c5fd;
      border-color: #3b82f6;
    }

    .p-75 {
      background: #5b21b6;
      color: #c4b5fd;
      border-color: #8b5cf6;
    }

    .p-100 {
      background: #065f46;
      color: #6ee7b7;
      border-color: #10b981;
    }

    /* Expand Toggle */
    .expand-toggle {
      font-size: 12px;
      color: #94a3b8;
      padding: 6px 12px;
      border-radius: 6px;
      background: #0f1621;
      border: 1px solid #2d3f56;
      cursor: pointer;
      transition: all 0.2s;
    }

    .expand-toggle:hover {
      background: #223044;
      border-color: #3b82f6;
      color: #60a5fa;
    }

    .expand-toggle::after {
      content: ' ▼';
    }

    .screen-row.expanded .expand-toggle::after {
      content: ' ▲';
    }

    /* Expanded Details */
    .row-details {
      padding: 0 16px 16px;
      display: none;
      border-top: 1px solid #2d3f56;
      margin-top: 8px;
      padding-top: 16px;
    }

    .screen-row.expanded .row-details {
      display: block;
    }

    .details-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 16px;
    }

    .detail-field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .detail-label {
      font-size: 11px;
      color: #94a3b8;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .detail-input {
      width: 100%;
      border: 1px solid #2d3f56;
      border-radius: 6px;
      padding: 8px 10px;
      font-size: 13px;
      background: #0f1621;
      color: #e8eef6;
      font-family: inherit;
    }

    .detail-input:focus {
      outline: none;
      border-color: #3b82f6;
      background: #1a2535;
    }

    textarea.detail-input {
      min-height: 80px;
      resize: vertical;
    }

    .full-width {
      grid-column: 1 / -1;
    }

    .delete-btn {
      padding: 6px 16px;
      border-radius: 6px;
      border: 1px solid #2d3f56;
      background: #1a2535;
      color: #94a3b8;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .delete-btn:hover {
      background: #7f1d1d;
      border-color: #ef4444;
      color: #fca5a5;
    }

    /* Phone Modal */
    .phone-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .phone-modal.active {
      display: flex;
    }

    .phone-preview {
      width: 375px;
      height: 667px;
      background: #1a2535;
      border: 3px solid;
      border-radius: 30px;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      display: flex;
      flex-direction: column;
      padding: 20px;
    }

    .phone-preview::before {
      content: '';
      width: 120px;
      height: 20px;
      background: #0f1621;
      border-radius: 10px;
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
    }

    .phone-screen {
      flex: 1;
      background: #0f1621;
      border-radius: 10px;
      margin-top: 30px;
      padding: 20px;
      overflow-y: auto;
      border: 1px solid #2d3f56;
    }

    .phone-title {
      font-size: 18px;
      font-weight: 700;
      color: #60a5fa;
      margin-bottom: 12px;
    }

    .phone-details {
      font-size: 13px;
      color: #94a3b8;
      line-height: 1.6;
    }

    .close-modal {
      position: absolute;
      top: -50px;
      right: 0;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #ef4444;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-modal:hover {
      background: #dc2626;
    }

    @media (max-width: 1400px) {
      .row-main {
        grid-template-columns: 200px 60px repeat(var(--cols), 100px) 80px;
        gap: 8px;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Header -->
  <div class="header">
    <h1>Screen Design Tracker</h1>
    <div class="header-nav">
      <a href="admin-dashboard.html" class="btn">Dashboard</a>
      <a href="progress-view.html" class="btn secondary">Progress View</a>
      <button class="btn success" onclick="addScreen()">+ Add Screen</button>
      <button class="btn success" onclick="addColumn()">+ Add Column</button>
    </div>
  </div>

  <!-- Board -->
  <div class="board">
    <div class="column-manager" id="columnManager"></div>
    <div id="screensContainer"></div>
  </div>
</div>

<!-- Phone Modal -->
<div class="phone-modal" id="phoneModal">
  <button class="close-modal" onclick="closePhoneModal()">×</button>
  <div class="phone-preview" id="phonePreview">
    <div class="phone-screen">
      <div class="phone-title" id="modalTitle">Screen Title</div>
      <div class="phone-details" id="modalDetails"></div>
    </div>
  </div>
</div>

<script>
  const progressStates = [
    { cls: "p-0", text: "0%" },
    { cls: "p-25", text: "25%" },
    { cls: "p-50", text: "50%" },
    { cls: "p-75", text: "75%" },
    { cls: "p-100", text: "100%" }
  ];

  let columns = [
    "Wireframe", "Buttons", "Tables", "Connections",
    "Testing", "UI", "AI", "Beta", "Prod"
  ];

  let screens = [
    {
      title: "Login Page",
      address: "login.html",
      version: "v1.2",
      notes: "Main authentication screen with OAuth integration",
      color: 0,
      expanded: false,
      progress: [4, 4, 3, 3, 2, 2, 1, 0, 0]
    },
    {
      title: "Dashboard",
      address: "dashboard.html",
      version: "v2.0",
      notes: "Main user dashboard with stats and widgets",
      color: 1,
      expanded: false,
      progress: [4, 3, 3, 2, 1, 1, 0, 0, 0]
    }
  ];

  function render() {
    const container = document.getElementById("screensContainer");
    container.style.setProperty("--cols", columns.length);
    container.innerHTML = "";

    screens.forEach((screen, si) => {
      const row = document.createElement("div");
      row.className = "screen-row" + (screen.expanded ? " expanded" : "");

      // Main Row
      const main = document.createElement("div");
      main.className = "row-main";
      main.onclick = (e) => {
        if (!e.target.closest('.progress-cell') && !e.target.closest('.phone-outline') && !e.target.closest('.expand-toggle')) {
          screen.expanded = !screen.expanded;
          render();
        }
      };

      // Title
      const title = document.createElement("div");
      title.className = "screen-title";
      title.textContent = screen.title || "Untitled Screen";

      // Phone Icon
      const phone = document.createElement("div");
      phone.className = `phone-outline color-${screen.color}`;
      phone.onclick = (e) => {
        e.stopPropagation();
        showPhoneModal(screen);
      };

      main.appendChild(title);
      main.appendChild(phone);

      // Ensure progress array matches columns
      while (screen.progress.length < columns.length) {
        screen.progress.push(0);
      }
      while (screen.progress.length > columns.length) {
        screen.progress.pop();
      }

      // Progress Cells
      screen.progress.forEach((state, ci) => {
        const cell = document.createElement("div");
        cell.className = `progress-cell ${progressStates[state].cls}`;
        cell.onclick = (e) => {
          e.stopPropagation();
          screen.progress[ci] = (state + 1) % progressStates.length;
          render();
        };

        const label = document.createElement("div");
        label.className = "cell-label";
        label.textContent = columns[ci];

        const percent = document.createElement("div");
        percent.className = "cell-percent";
        percent.textContent = progressStates[state].text;

        cell.appendChild(label);
        cell.appendChild(percent);
        main.appendChild(cell);
      });

      // Expand Toggle
      const toggle = document.createElement("div");
      toggle.className = "expand-toggle";
      toggle.textContent = "Details";
      toggle.onclick = (e) => {
        e.stopPropagation();
        screen.expanded = !screen.expanded;
        render();
      };

      main.appendChild(toggle);

      // Details Section
      const details = document.createElement("div");
      details.className = "row-details";

      const grid = document.createElement("div");
      grid.className = "details-grid";

      // Title Edit
      const titleField = document.createElement("div");
      titleField.className = "detail-field full-width";
      titleField.innerHTML = `
        <div class="detail-label">Screen Title</div>
        <input class="detail-input" value="${screen.title || ''}" 
               placeholder="Working Title" 
               oninput="screens[${si}].title = this.value; render()">
      `;

      // Address
      const addressField = document.createElement("div");
      addressField.className = "detail-field";
      addressField.innerHTML = `
        <div class="detail-label">Screen File</div>
        <input class="detail-input" value="${screen.address || ''}" 
               placeholder="e.g., login.html" 
               oninput="screens[${si}].address = this.value">
      `;

      // Version
      const versionField = document.createElement("div");
      versionField.className = "detail-field";
      versionField.innerHTML = `
        <div class="detail-label">Version</div>
        <input class="detail-input" value="${screen.version || ''}" 
               placeholder="e.g., v1.0" 
               oninput="screens[${si}].version = this.value">
      `;

      // Color
      const colorField = document.createElement("div");
      colorField.className = "detail-field";
      colorField.innerHTML = `
        <div class="detail-label">Color Theme</div>
        <select class="detail-input" onchange="screens[${si}].color = parseInt(this.value); render()">
          ${[0,1,2,3,4,5,6,7,8,9].map(i => 
            `<option value="${i}" ${screen.color === i ? 'selected' : ''}>Theme ${i + 1}</option>`
          ).join('')}
        </select>
      `;

      // Notes
      const notesField = document.createElement("div");
      notesField.className = "detail-field full-width";
      notesField.innerHTML = `
        <div class="detail-label">Notes</div>
        <textarea class="detail-input" 
                  placeholder="Screen details, requirements, notes..."
                  oninput="screens[${si}].notes = this.value">${screen.notes || ''}</textarea>
      `;

      // Delete
      const deleteField = document.createElement("div");
      deleteField.className = "detail-field";
      deleteField.innerHTML = `
        <div class="detail-label">&nbsp;</div>
        <button class="delete-btn" onclick="deleteScreen(${si})">Delete Screen</button>
      `;

      grid.appendChild(titleField);
      grid.appendChild(addressField);
      grid.appendChild(versionField);
      grid.appendChild(colorField);
      grid.appendChild(notesField);
      grid.appendChild(deleteField);

      details.appendChild(grid);
      row.appendChild(main);
      row.appendChild(details);
      container.appendChild(row);
    });

    renderColumnManager();
  }

  function renderColumnManager() {
    const manager = document.getElementById("columnManager");
    manager.innerHTML = columns.map((col, i) => `
      <div class="column-tag">
        <input value="${col}" oninput="columns[${i}] = this.value; render()">
        <button onclick="deleteColumn(${i})" title="Delete column">×</button>
      </div>
    `).join('');
  }

  function addScreen() {
    screens.push({
      title: "",
      address: "",
      version: "",
      notes: "",
      color: Math.floor(Math.random() * 10),
      expanded: true,
      progress: Array(columns.length).fill(0)
    });
    render();
  }

  function deleteScreen(index) {
    if (confirm("Delete this screen?")) {
      screens.splice(index, 1);
      render();
    }
  }

  function addColumn() {
    const name = prompt("Column name:", "New Stage");
    if (name) {
      columns.push(name);
      screens.forEach(s => s.progress.push(0));
      render();
    }
  }

  function deleteColumn(index) {
    if (confirm(`Delete column "${columns[index]}"?`)) {
      columns.splice(index, 1);
      screens.forEach(s => s.progress.splice(index, 1));
      render();
    }
  }

  function showPhoneModal(screen) {
    const modal = document.getElementById("phoneModal");
    const preview = document.getElementById("phonePreview");
    const title = document.getElementById("modalTitle");
    const details = document.getElementById("modalDetails");

    const colors = ['#3b82f6', '#06b6d4', '#10b981', '#8b5cf6', '#6366f1', 
                    '#14b8a6', '#0ea5e9', '#a855f7', '#22d3ee', '#818cf8'];
    preview.style.borderColor = colors[screen.color];
    
    title.textContent = screen.title || "Untitled Screen";
    
    let detailsHTML = `
      <strong>File:</strong> ${screen.address || 'Not specified'}<br>
      <strong>Version:</strong> ${screen.version || 'Not specified'}<br><br>
      <strong>Progress:</strong><br>
    `;

    columns.forEach((col, i) => {
      const progress = progressStates[screen.progress[i]];
      detailsHTML += `${col}: ${progress.text}<br>`;
    });

    if (screen.notes) {
      detailsHTML += `<br><strong>Notes:</strong><br>${screen.notes}`;
    }

    details.innerHTML = detailsHTML;
    modal.classList.add("active");
  }

  function closePhoneModal() {
    document.getElementById("phoneModal").classList.remove("active");
  }

  document.getElementById("phoneModal").onclick = (e) => {
    if (e.target.id === "phoneModal") closePhoneModal();
  };

  render();
</script>

</body>
</html>
