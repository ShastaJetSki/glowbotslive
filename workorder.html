<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Work Order - GlowbotsLive</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --cyan: #00d9ff;
      --pink: #ff1493;
      --white: #ffffff;
      --black: #000000;
    }

    body {
      font-family: 'Orbitron', sans-serif;
      background: var(--black);
      color: var(--white);
      min-height: 100vh;
    }

    /* Topbar */
    .topbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 80px;
      background: var(--black);
      border-bottom: 2px solid var(--cyan);
      display: flex;
      align-items: center;
      padding: 0 2rem;
      z-index: 100;
      box-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
    }

    .logo {
      font-size: 1.8rem;
      font-weight: 900;
      color: var(--cyan);
      text-shadow: 0 0 10px var(--cyan), 0 0 20px var(--cyan);
      letter-spacing: 3px;
    }

    .back-btn {
      margin-left: auto;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 2px;
      padding: 0.75rem 1.5rem;
      background: transparent;
      border: 2px solid var(--cyan);
      color: var(--cyan);
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s;
    }

    .back-btn:hover {
      background: var(--cyan);
      color: var(--black);
      box-shadow: 0 0 20px var(--cyan);
    }

    /* Main Content */
    .main-content {
      margin-top: 80px;
      padding: 3rem 2rem;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
    }

    .page-header {
      margin-bottom: 3rem;
    }

    .page-title {
      font-size: 3.5rem;
      font-weight: 900;
      letter-spacing: -2px;
      margin-bottom: 0.5rem;
      color: var(--cyan);
      text-transform: uppercase;
      text-shadow: 0 0 20px var(--cyan), 0 0 40px var(--cyan);
    }

    .page-subtitle {
      font-size: 1.2rem;
      color: var(--white);
      font-weight: 400;
      letter-spacing: 3px;
    }

    /* Form Card */
    .form-card {
      background: rgba(10, 10, 10, 0.8);
      border: 2px solid var(--cyan);
      padding: 3rem;
      box-shadow: 0 0 20px rgba(0, 217, 255, 0.3);
    }

    .form-section {
      margin-bottom: 3rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid rgba(0, 217, 255, 0.3);
    }

    .form-section:last-child {
      border-bottom: none;
    }

    .section-title {
      font-size: 1.2rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 3px;
      color: var(--cyan);
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .section-title::before {
      content: '';
      width: 4px;
      height: 24px;
      background: var(--cyan);
      box-shadow: 0 0 10px var(--cyan);
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .form-grid.two-col {
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    label {
      font-size: 0.85rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: var(--cyan);
      margin-bottom: 0.75rem;
      text-shadow: 0 0 10px var(--cyan);
    }

    input, select, textarea {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      font-weight: 500;
      padding: 1rem 1.25rem;
      background: var(--black);
      border: 2px solid var(--cyan);
      color: var(--white);
      transition: all 0.3s;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--pink);
      box-shadow: 0 0 20px var(--pink);
    }

    textarea {
      resize: vertical;
      min-height: 120px;
    }

    input::placeholder, textarea::placeholder {
      color: rgba(255, 255, 255, 0.3);
    }

    /* Buttons */
    .button-group {
      display: flex;
      gap: 1.5rem;
      margin-top: 3rem;
    }

    .btn {
      flex: 1;
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: 3px;
      padding: 1.5rem;
      border: none;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-primary {
      background: var(--cyan);
      color: var(--black);
      box-shadow: 0 0 20px var(--cyan);
    }

    .btn-primary:hover {
      transform: translateY(-4px);
      box-shadow: 0 0 40px var(--cyan);
    }

    .btn-secondary {
      background: transparent;
      border: 2px solid var(--cyan);
      color: var(--cyan);
    }

    .btn-secondary:hover {
      background: rgba(0, 217, 255, 0.1);
    }

    /* Alert */
    .alert {
      padding: 1.5rem;
      margin-top: 2rem;
      font-weight: 600;
      text-align: center;
      display: none;
      border: 2px solid;
    }

    .alert.show {
      display: block;
    }

    .alert.success {
      background: rgba(0, 217, 255, 0.2);
      border-color: var(--cyan);
      color: var(--cyan);
      box-shadow: 0 0 30px rgba(0, 217, 255, 0.5);
    }

    .alert.error {
      background: rgba(255, 20, 147, 0.2);
      border-color: var(--pink);
      color: var(--pink);
      box-shadow: 0 0 30px rgba(255, 20, 147, 0.5);
    }

    @media (max-width: 768px) {
      .page-title { font-size: 2.5rem; }
      .form-card { padding: 2rem 1.5rem; }
      .button-group { flex-direction: column; }
    }
  </style>
</head>
<body>
  <!-- Topbar -->
  <div class="topbar">
    <div class="logo">GLOWBOTSLIVE</div>
    <a href="dashboard.html" class="back-btn">← BACK</a>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="page-header">
      <h1 class="page-title">NEW ORDER</h1>
      <p class="page-subtitle">CREATE WORK ORDER</p>
    </div>

    <!-- Form -->
    <div class="form-card">
      <form id="workOrderForm">
        <!-- Business -->
        <div class="form-section">
          <h3 class="section-title">BUSINESS</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>BUSINESS NAME</label>
              <select id="business" required>
                <option value="">Select business...</option>
                <option value="Premium Auto Care">Premium Auto Care</option>
                <option value="Sunset Marine Services">Sunset Marine Services</option>
                <option value="Green Valley Lawn Care & Repair">Green Valley Lawn Care</option>
                <option value="Quick Fix Appliance Repair">Quick Fix Appliance</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Customer -->
        <div class="form-section">
          <h3 class="section-title">CUSTOMER</h3>
          <div class="form-grid two-col">
            <div class="form-group">
              <label>FIRST NAME</label>
              <input type="text" id="firstName" required>
            </div>
            <div class="form-group">
              <label>LAST NAME</label>
              <input type="text" id="lastName" required>
            </div>
          </div>
        </div>

        <!-- Service -->
        <div class="form-section">
          <h3 class="section-title">SERVICE DETAILS</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>SERVICE TYPE</label>
              <select id="serviceType" required>
                <option value="">Select service...</option>
                <option value="Oil Change & Filter">Oil Change & Filter</option>
                <option value="Brake Service">Brake Service</option>
                <option value="Engine Service">Engine Service</option>
                <option value="Boat Detailing">Boat Detailing</option>
                <option value="Mower Tune-Up">Mower Tune-Up</option>
                <option value="Refrigerator Repair">Refrigerator Repair</option>
              </select>
            </div>

            <div class="form-grid two-col">
              <div class="form-group">
                <label>DATE</label>
                <input type="date" id="scheduledDate" required>
              </div>
              <div class="form-group">
                <label>START TIME</label>
                <input type="time" id="startTime" value="10:00" required>
              </div>
            </div>

            <div class="form-grid two-col">
              <div class="form-group">
                <label>END TIME</label>
                <input type="time" id="endTime" value="11:00" required>
              </div>
              <div class="form-group">
                <label>PRIORITY</label>
                <select id="priority" required>
                  <option value="low">Low</option>
                  <option value="normal" selected>Normal</option>
                  <option value="high">High</option>
                  <option value="urgent">Urgent</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label>NOTES</label>
              <textarea id="notes" placeholder="Internal notes..."></textarea>
            </div>
          </div>
        </div>

        <!-- Pricing -->
        <div class="form-section">
          <h3 class="section-title">PRICING</h3>
          <div class="form-grid two-col">
            <div class="form-group">
              <label>TOTAL AMOUNT</label>
              <input type="number" id="totalAmount" step="0.01" placeholder="0.00" required>
            </div>
            <div class="form-group">
              <label>LABOR TOTAL</label>
              <input type="number" id="laborTotal" step="0.01" placeholder="0.00" required>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="button-group">
          <button type="button" class="btn btn-secondary" onclick="resetForm()">RESET</button>
          <button type="submit" class="btn btn-primary">CREATE ORDER</button>
        </div>
      </form>

      <div id="alert" class="alert"></div>
    </div>
  </div>

  <script>
    if (!sessionStorage.getItem('isAuthenticated')) {
      window.location.href = 'login.html';
    }

    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('scheduledDate').value = tomorrow.toISOString().split('T')[0];

    document.getElementById('workOrderForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      await createWorkOrder();
    });

    async function createWorkOrder() {
      const business = document.getElementById('business').value;
      const firstName = document.getElementById('firstName').value;
      const lastName = document.getElementById('lastName').value;
      const serviceType = document.getElementById('serviceType').value;
      const scheduledDate = document.getElementById('scheduledDate').value;
      const totalAmount = parseFloat(document.getElementById('totalAmount').value);

      showAlert('⚡ Creating work order...', 'success');

      await new Promise(resolve => setTimeout(resolve, 1500));

      const orderNumber = 'RO-2025-' + String(Math.floor(Math.random() * 1000)).padStart(3, '0');

      let mockOrders = JSON.parse(sessionStorage.getItem('mockOrders') || '[]');
      mockOrders.push({
        id: mockOrders.length + 1,
        order_number: orderNumber,
        customer: `${firstName} ${lastName}`,
        phone: '555-0000',
        vehicle: 'N/A',
        service: serviceType,
        scheduled_date: scheduledDate,
        status: 'scheduled',
        total_amount: totalAmount
      });
      sessionStorage.setItem('mockOrders', JSON.stringify(mockOrders));

      showAlert(`✅ Work order ${orderNumber} created successfully!`, 'success');
      
      setTimeout(() => {
        window.location.href = 'dashboard.html';
      }, 2000);
    }

    function showAlert(message, type) {
      const alert = document.getElementById('alert');
      alert.textContent = message;
      alert.className = `alert ${type} show`;
    }

    function resetForm() {
      document.getElementById('workOrderForm').reset();
      document.getElementById('alert').classList.remove('show');
      
      const tomorrow = new Date();
      tomorrow.setDate(tomorrow.getDate() + 1);
      document.getElementById('scheduledDate').value = tomorrow.toISOString().split('T')[0];
    }
  </script>
</body>
</html>
